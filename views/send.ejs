<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <link href="styles/index.css" rel="stylesheet">
    <title>Medical Report Analyser</title>
</head>
<body style="background-color: #f5f9fc; ">
    <%-include("header.ejs")%>
    <div style="margin-top: 5%; margin-bottom: 13%;">
    <div class="login-box"> <h1 style="text-align: center; margin-bottom: 1rem;">Add The Report To Analyse</h1>

  <form id="uploadForm" style="text-align: center;">
    <input type="file" id="imageInput" name="reportImage" accept="image/*" required>
    <br> <button type="submit" class="btn btn-primary" style="margin-top: 10px;">Upload</button>
  </form>

</div>

<div style="margin-top: 20px;">
  <h3 style="text-align: center;">Extracted Text:</h3>
  <div id="resultBox" style="white-space: pre-wrap; background: #eee; padding: 15px; border-radius: 5px; max-width: 800px; margin: auto;">
    Your report text will appear here...
  </div>
</div>
  </form></div></div>
 

  <%-include("footer.ejs")%>
</body>
<script>
  const uploadForm = document.getElementById('uploadForm');
  const imageInput = document.getElementById('imageInput');
  const resultBox = document.getElementById('resultBox');

  uploadForm.addEventListener('submit', async (e) => {
    e.preventDefault(); // Stop the page from reloading

    const formData = new FormData();
    formData.append('reportImage', imageInput.files[0]);

    resultBox.textContent = 'Processing... Please wait.';

    try {
      // Send the image to the backend route you made
      const response = await fetch('/scan-report', {
        method: 'POST',
        body: formData
      });

      const result = await response.json();

      if (result.extractedText) {
        resultBox.textContent = result.extractedText;
      } else {
        resultBox.textContent = 'Error: ' + result.error;
      }

    } catch (error) {
      console.error('Error:', error);
      resultBox.textContent = 'Failed to connect to the server.';
    }
  });
</script>
</html>